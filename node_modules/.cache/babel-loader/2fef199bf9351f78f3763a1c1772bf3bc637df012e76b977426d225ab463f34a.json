{"ast":null,"code":"import _objectSpread from\"/home/user/Documents/a11/Homely/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/components/OrderDetails.js\nimport React,{useState,useEffect}from\"react\";import{auth,firestore}from\"../firebase/firebaseConfig\";// ✅ Use `firestore`\nimport{doc,getDoc,updateDoc}from\"firebase/firestore\";// ✅ Modular Firestore functions\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderDetails=_ref=>{var _order$orderDate,_order$orderDate$toDa;let{orderId}=_ref;const[order,setOrder]=useState(null);const[newStatus,setNewStatus]=useState(\"\");const[userRole,setUserRole]=useState(null);// Store user role\nuseEffect(()=>{const fetchOrderDetails=async()=>{try{const orderRef=doc(firestore,\"orders\",orderId);// ✅ Firestore reference\nconst orderSnap=await getDoc(orderRef);// ✅ Get document snapshot\nif(orderSnap.exists()){setOrder(_objectSpread({id:orderSnap.id},orderSnap.data()));setNewStatus(orderSnap.data().status);}else{console.error(\"Order not found\");}}catch(error){console.error(\"Error fetching order details:\",error);}};const fetchUserRole=async()=>{const user=auth.currentUser;if(user){try{const userRef=doc(firestore,\"users\",user.uid);// ✅ Reference to user doc\nconst userSnap=await getDoc(userRef);if(userSnap.exists()){setUserRole(userSnap.data().role);}}catch(error){console.error(\"Error fetching user role:\",error);}}};fetchOrderDetails();fetchUserRole();},[orderId]);const handleStatusChange=async()=>{if(!order)return;try{const orderRef=doc(firestore,\"orders\",order.id);// ✅ Reference to Firestore document\nawait updateDoc(orderRef,{status:newStatus});// ✅ Update Firestore document\nsetOrder(prevOrder=>_objectSpread(_objectSpread({},prevOrder),{},{status:newStatus}));// ✅ Update UI\nalert(\"Order status updated!\");}catch(error){console.error(\"Error updating order status:\",error);alert(\"Error updating order status.\");}};if(!order)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Order Details\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order ID:\"}),\" \",order.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",order.status]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total:\"}),\" $\",order.total]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order Date:\"}),\" \",(_order$orderDate=order.orderDate)===null||_order$orderDate===void 0?void 0:(_order$orderDate$toDa=_order$orderDate.toDate())===null||_order$orderDate$toDa===void 0?void 0:_order$orderDate$toDa.toString()]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Delivery Address:\"}),\" \",order.deliveryAddress]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Dishes Ordered:\"}),/*#__PURE__*/_jsx(\"ul\",{children:order.dishes.map((dish,index)=>/*#__PURE__*/_jsxs(\"li\",{children:[dish.name,\" - \",dish.quantity,\" x $\",dish.price]},index))}),(userRole===\"admin\"||userRole===\"cook\")&&order.status!==\"completed\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Update Status: \"}),/*#__PURE__*/_jsxs(\"select\",{value:newStatus,onChange:e=>setNewStatus(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(\"option\",{value:\"in progress\",children:\"In Progress\"}),/*#__PURE__*/_jsx(\"option\",{value:\"completed\",children:\"Completed\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleStatusChange,children:\"Update Status\"})]})]});};export default OrderDetails;","map":{"version":3,"names":["React","useState","useEffect","auth","firestore","doc","getDoc","updateDoc","jsx","_jsx","jsxs","_jsxs","OrderDetails","_ref","_order$orderDate","_order$orderDate$toDa","orderId","order","setOrder","newStatus","setNewStatus","userRole","setUserRole","fetchOrderDetails","orderRef","orderSnap","exists","_objectSpread","id","data","status","console","error","fetchUserRole","user","currentUser","userRef","uid","userSnap","role","handleStatusChange","prevOrder","alert","children","total","orderDate","toDate","toString","deliveryAddress","dishes","map","dish","index","name","quantity","price","value","onChange","e","target","onClick"],"sources":["/home/user/Documents/a11/Homely/src/components/OrderDetails.js"],"sourcesContent":["// src/components/OrderDetails.js\nimport React, { useState, useEffect } from \"react\";\nimport { auth, firestore } from \"../firebase/firebaseConfig\"; // ✅ Use `firestore`\nimport { doc, getDoc, updateDoc } from \"firebase/firestore\"; // ✅ Modular Firestore functions\n\nconst OrderDetails = ({ orderId }) => {\n  const [order, setOrder] = useState(null);\n  const [newStatus, setNewStatus] = useState(\"\");\n  const [userRole, setUserRole] = useState(null); // Store user role\n\n  useEffect(() => {\n    const fetchOrderDetails = async () => {\n      try {\n        const orderRef = doc(firestore, \"orders\", orderId); // ✅ Firestore reference\n        const orderSnap = await getDoc(orderRef); // ✅ Get document snapshot\n\n        if (orderSnap.exists()) {\n          setOrder({ id: orderSnap.id, ...orderSnap.data() });\n          setNewStatus(orderSnap.data().status);\n        } else {\n          console.error(\"Order not found\");\n        }\n      } catch (error) {\n        console.error(\"Error fetching order details:\", error);\n      }\n    };\n\n    const fetchUserRole = async () => {\n      const user = auth.currentUser;\n      if (user) {\n        try {\n          const userRef = doc(firestore, \"users\", user.uid); // ✅ Reference to user doc\n          const userSnap = await getDoc(userRef);\n          if (userSnap.exists()) {\n            setUserRole(userSnap.data().role);\n          }\n        } catch (error) {\n          console.error(\"Error fetching user role:\", error);\n        }\n      }\n    };\n\n    fetchOrderDetails();\n    fetchUserRole();\n  }, [orderId]);\n\n  const handleStatusChange = async () => {\n    if (!order) return;\n\n    try {\n      const orderRef = doc(firestore, \"orders\", order.id); // ✅ Reference to Firestore document\n      await updateDoc(orderRef, { status: newStatus }); // ✅ Update Firestore document\n      setOrder((prevOrder) => ({ ...prevOrder, status: newStatus })); // ✅ Update UI\n      alert(\"Order status updated!\");\n    } catch (error) {\n      console.error(\"Error updating order status:\", error);\n      alert(\"Error updating order status.\");\n    }\n  };\n\n  if (!order) return <p>Loading...</p>;\n\n  return (\n    <div>\n      <h3>Order Details</h3>\n      <p><strong>Order ID:</strong> {order.id}</p>\n      <p><strong>Status:</strong> {order.status}</p>\n      <p><strong>Total:</strong> ${order.total}</p>\n      <p><strong>Order Date:</strong> {order.orderDate?.toDate()?.toString()}</p>\n      <p><strong>Delivery Address:</strong> {order.deliveryAddress}</p>\n\n      <h3>Dishes Ordered:</h3>\n      <ul>\n        {order.dishes.map((dish, index) => (\n          <li key={index}>{dish.name} - {dish.quantity} x ${dish.price}</li>\n        ))}\n      </ul>\n\n      {/* Only show status update for Admin/Cook */}\n      {(userRole === \"admin\" || userRole === \"cook\") && order.status !== \"completed\" && (\n        <div>\n          <label>Update Status: </label>\n          <select value={newStatus} onChange={(e) => setNewStatus(e.target.value)}>\n            <option value=\"pending\">Pending</option>\n            <option value=\"in progress\">In Progress</option>\n            <option value=\"completed\">Completed</option>\n          </select>\n          <button onClick={handleStatusChange}>Update Status</button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default OrderDetails;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}