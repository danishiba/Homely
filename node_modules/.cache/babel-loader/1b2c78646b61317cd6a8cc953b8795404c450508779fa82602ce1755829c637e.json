{"ast":null,"code":"import React,{useState}from\"react\";import{firestore}from\"../firebase/firebaseConfig\";import{collection,addDoc}from\"firebase/firestore\";import'./adddish.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AddDish=_ref=>{let{cookId,onDishAdded,onCancel}=_ref;const[name,setName]=useState(\"\");const[description,setDescription]=useState(\"\");const[price,setPrice]=useState(\"\");const[imageFile,setImageFile]=useState(null);const[quantity,setQuantity]=useState(\"\");const[loading,setLoading]=useState(false);const handleImageChange=e=>{setImageFile(e.target.files[0]);};const uploadToCloudinary=async file=>{const formData=new FormData();formData.append(\"file\",file);formData.append(\"upload_preset\",\"my_unsigned_preset\");try{const response=await fetch(\"https://api.cloudinary.com/v1_1/dcmbqtbv7/image/upload\",{method:\"POST\",body:formData});if(!response.ok){throw new Error(\"Failed to upload image.\");}const data=await response.json();return data.secure_url;}catch(error){console.error(\"Image upload error:\",error);alert(\"Image upload failed. Please try again.\");return null;}};const handleAddDish=async()=>{if(!name||!price||!quantity||!imageFile){alert(\"Please fill in all required fields.\");return;}if(quantity<=0){alert(\"Quantity must be greater than 0.\");return;}setLoading(true);const imageUrl=await uploadToCloudinary(imageFile);if(!imageUrl){setLoading(false);return;}const dish={name,description,price:parseFloat(price),imageUrl,quantity:parseInt(quantity,10),cookId,createdAt:new Date()};try{await addDoc(collection(firestore,\"dishes\"),dish);alert(\"Dish added successfully!\");onDishAdded();onCancel();}catch(error){console.error(\"Error adding dish:\",error);alert(\"Failed to add dish. Please try again.\");}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"add-dish-overlay\",onClick:onCancel}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-dish-modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Add a New Dish\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Dish Name\",value:name,onChange:e=>setName(e.target.value)}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Dish Description\",value:description,onChange:e=>setDescription(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Price\",value:price,onChange:e=>setPrice(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageChange}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Quantity\",value:quantity,onChange:e=>setQuantity(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddDish,disabled:loading,children:loading?\"Adding...\":\"Add Dish\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"cancel-btn\",children:\"Cancel\"})]})]});};export default AddDish;","map":{"version":3,"names":["React","useState","firestore","collection","addDoc","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AddDish","_ref","cookId","onDishAdded","onCancel","name","setName","description","setDescription","price","setPrice","imageFile","setImageFile","quantity","setQuantity","loading","setLoading","handleImageChange","e","target","files","uploadToCloudinary","file","formData","FormData","append","response","fetch","method","body","ok","Error","data","json","secure_url","error","console","alert","handleAddDish","imageUrl","dish","parseFloat","parseInt","createdAt","Date","children","className","onClick","type","placeholder","value","onChange","accept","disabled"],"sources":["/home/user/Documents/a11/Homely/src/components/AddDish.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { firestore } from \"../firebase/firebaseConfig\";\nimport { collection, addDoc } from \"firebase/firestore\";\nimport './adddish.css';\n\nconst AddDish = ({ cookId, onDishAdded, onCancel }) => {\n  const [name, setName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [price, setPrice] = useState(\"\");\n  const [imageFile, setImageFile] = useState(null);\n  const [quantity, setQuantity] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const handleImageChange = (e) => {\n    setImageFile(e.target.files[0]);\n  };\n\n  const uploadToCloudinary = async (file) => {\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    formData.append(\"upload_preset\", \"my_unsigned_preset\");\n\n    try {\n      const response = await fetch(\"https://api.cloudinary.com/v1_1/dcmbqtbv7/image/upload\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to upload image.\");\n      }\n\n      const data = await response.json();\n      return data.secure_url;\n    } catch (error) {\n      console.error(\"Image upload error:\", error);\n      alert(\"Image upload failed. Please try again.\");\n      return null;\n    }\n  };\n\n  const handleAddDish = async () => {\n    if (!name || !price || !quantity || !imageFile) {\n      alert(\"Please fill in all required fields.\");\n      return;\n    }\n\n    if (quantity <= 0) {\n      alert(\"Quantity must be greater than 0.\");\n      return;\n    }\n\n    setLoading(true);\n\n    const imageUrl = await uploadToCloudinary(imageFile);\n    if (!imageUrl) {\n      setLoading(false);\n      return;\n    }\n\n    const dish = {\n      name,\n      description,\n      price: parseFloat(price),\n      imageUrl,\n      quantity: parseInt(quantity, 10),\n      cookId,\n      createdAt: new Date(),\n    };\n\n    try {\n      await addDoc(collection(firestore, \"dishes\"), dish);\n      alert(\"Dish added successfully!\");\n      onDishAdded();\n      onCancel();\n    } catch (error) {\n      console.error(\"Error adding dish:\", error);\n      alert(\"Failed to add dish. Please try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <>\n      <div className=\"add-dish-overlay\" onClick={onCancel}></div>\n      <div className=\"add-dish-modal\">\n        <h2>Add a New Dish</h2>\n        <input type=\"text\" placeholder=\"Dish Name\" value={name} onChange={(e) => setName(e.target.value)} />\n        <textarea placeholder=\"Dish Description\" value={description} onChange={(e) => setDescription(e.target.value)} />\n        <input type=\"number\" placeholder=\"Price\" value={price} onChange={(e) => setPrice(e.target.value)} />\n        <input type=\"file\" accept=\"image/*\" onChange={handleImageChange} />\n        <input type=\"number\" placeholder=\"Quantity\" value={quantity} onChange={(e) => setQuantity(e.target.value)} />\n\n        <button onClick={handleAddDish} disabled={loading}>\n          {loading ? \"Adding...\" : \"Add Dish\"}\n        </button>\n        <button onClick={onCancel} className=\"cancel-btn\">Cancel</button>\n      </div>\n    </>\n  );\n};\n\nexport default AddDish;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}