{"ast":null,"code":"import _objectSpread from\"/home/user/Documents/a11/Homely/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{auth,firestore}from'../firebase/firebaseConfig';import{useNavigate}from'react-router-dom';import{doc,getDoc,collection,query,where,getDocs,updateDoc}from'firebase/firestore';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CustomerProfile=()=>{const[customerData,setCustomerData]=useState(null);const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const navigate=useNavigate();const user=auth.currentUser;useEffect(()=>{if(!user){navigate('/login');return;}const fetchCustomerData=async()=>{try{const userDocRef=doc(firestore,'users',user.uid);const userDoc=await getDoc(userDocRef);if(userDoc.exists()){const userData=userDoc.data();if(userData.role==='customer'){setCustomerData(userData);fetchOrders(user.uid);}else{navigate('/login');}}else{navigate('/login');}}catch(error){console.error('Error fetching customer data:',error);navigate('/login');}};const fetchOrders=async customerId=>{try{const ordersQuery=query(collection(firestore,'orders'),where('customerId','==',customerId));const ordersSnapshot=await getDocs(ordersQuery);const ordersList=ordersSnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setOrders(ordersList);}catch(error){console.error('Error fetching orders:',error);}finally{setLoading(false);}};fetchCustomerData();},[user,navigate]);const handleOrderClick=order=>{navigate('/order-details',{state:{order}});};const handleCancelOrder=async orderId=>{const confirmCancel=window.confirm(\"Are you sure you want to cancel this order?\");if(!confirmCancel)return;try{const orderRef=doc(firestore,'orders',orderId);await updateDoc(orderRef,{status:'cancelled'});// Update local state\nsetOrders(orders.map(order=>order.id===orderId?_objectSpread(_objectSpread({},order),{},{status:'cancelled'}):order));}catch(error){console.error(\"Error cancelling order:\",error);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{style:styles.profile,children:[/*#__PURE__*/_jsx(\"h2\",{style:styles.header,children:\"Customer Profile\"}),/*#__PURE__*/_jsxs(\"p\",{style:styles.text,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",customerData.name]}),/*#__PURE__*/_jsxs(\"p\",{style:styles.text,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",customerData.email]}),/*#__PURE__*/_jsx(\"h3\",{style:styles.orderHeader,children:\"Your Orders\"}),orders.length>0?/*#__PURE__*/_jsx(\"ul\",{style:styles.orderList,children:orders.map(order=>/*#__PURE__*/_jsxs(\"li\",{style:styles.orderItem,children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order ID:\"}),\" \",order.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total Price:\"}),\" $\",order.total]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",order.status]}),/*#__PURE__*/_jsx(\"button\",{style:styles.viewButton,onClick:()=>handleOrderClick(order),children:\"View Details\"}),order.status!==\"completed\"&&order.status!==\"cancelled\"&&/*#__PURE__*/_jsx(\"button\",{style:styles.cancelButton,onClick:()=>handleCancelOrder(order.id),children:\"Cancel Order\"})]},order.id))}):/*#__PURE__*/_jsx(\"p\",{style:styles.text,children:\"No orders placed yet.\"})]});};// ðŸŽ¨ Inline Styles\nconst styles={profile:{maxWidth:'600px',margin:'40px auto',padding:'20px',background:'#fff',boxShadow:'0 0 10px rgba(0, 0, 0, 0.1)',borderRadius:'10px',textAlign:'center'},header:{fontSize:'24px',marginBottom:'10px',color:'#333'},text:{fontSize:'16px',margin:'5px 0',color:'#555'},orderHeader:{marginTop:'20px',fontSize:'20px',color:'#444'},orderList:{listStyle:'none',padding:0},orderItem:{background:'#f8f8f8',padding:'15px',margin:'10px 0',borderRadius:'8px',transition:'0.3s'},viewButton:{background:'#007bff',color:'white',border:'none',padding:'8px 12px',margin:'5px',fontSize:'14px',cursor:'pointer',borderRadius:'5px',transition:'0.3s'},cancelButton:{background:'#ff4d4d',color:'white',border:'none',padding:'8px 12px',margin:'5px',fontSize:'14px',cursor:'pointer',borderRadius:'5px',transition:'0.3s'}};export default CustomerProfile;","map":{"version":3,"names":["React","useState","useEffect","auth","firestore","useNavigate","doc","getDoc","collection","query","where","getDocs","updateDoc","jsx","_jsx","jsxs","_jsxs","CustomerProfile","customerData","setCustomerData","orders","setOrders","loading","setLoading","navigate","user","currentUser","fetchCustomerData","userDocRef","uid","userDoc","exists","userData","data","role","fetchOrders","error","console","customerId","ordersQuery","ordersSnapshot","ordersList","docs","map","_objectSpread","id","handleOrderClick","order","state","handleCancelOrder","orderId","confirmCancel","window","confirm","orderRef","status","children","style","styles","profile","header","text","name","email","orderHeader","length","orderList","orderItem","total","viewButton","onClick","cancelButton","maxWidth","margin","padding","background","boxShadow","borderRadius","textAlign","fontSize","marginBottom","color","marginTop","listStyle","transition","border","cursor"],"sources":["/home/user/Documents/a11/Homely/src/pages/CustomerProfile.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { auth, firestore } from '../firebase/firebaseConfig';\nimport { useNavigate } from 'react-router-dom';\nimport { doc, getDoc, collection, query, where, getDocs, updateDoc } from 'firebase/firestore';\n\nconst CustomerProfile = () => {\n  const [customerData, setCustomerData] = useState(null);\n  const [orders, setOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const user = auth.currentUser;\n\n  useEffect(() => {\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n\n    const fetchCustomerData = async () => {\n      try {\n        const userDocRef = doc(firestore, 'users', user.uid);\n        const userDoc = await getDoc(userDocRef);\n\n        if (userDoc.exists()) {\n          const userData = userDoc.data();\n          if (userData.role === 'customer') {\n            setCustomerData(userData);\n            fetchOrders(user.uid);\n          } else {\n            navigate('/login');\n          }\n        } else {\n          navigate('/login');\n        }\n      } catch (error) {\n        console.error('Error fetching customer data:', error);\n        navigate('/login');\n      }\n    };\n\n    const fetchOrders = async (customerId) => {\n      try {\n        const ordersQuery = query(collection(firestore, 'orders'), where('customerId', '==', customerId));\n        const ordersSnapshot = await getDocs(ordersQuery);\n        const ordersList = ordersSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\n        setOrders(ordersList);\n      } catch (error) {\n        console.error('Error fetching orders:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchCustomerData();\n  }, [user, navigate]);\n\n  const handleOrderClick = (order) => {\n    navigate('/order-details', { state: { order } });\n  };\n\n  const handleCancelOrder = async (orderId) => {\n    const confirmCancel = window.confirm(\"Are you sure you want to cancel this order?\");\n    if (!confirmCancel) return;\n\n    try {\n      const orderRef = doc(firestore, 'orders', orderId);\n      await updateDoc(orderRef, { status: 'cancelled' });\n\n      // Update local state\n      setOrders(orders.map(order => \n        order.id === orderId ? { ...order, status: 'cancelled' } : order\n      ));\n    } catch (error) {\n      console.error(\"Error cancelling order:\", error);\n    }\n  };\n\n  if (loading) return <div>Loading...</div>;\n\n  return (\n    <div style={styles.profile}>\n      <h2 style={styles.header}>Customer Profile</h2>\n      <p style={styles.text}><strong>Name:</strong> {customerData.name}</p>\n      <p style={styles.text}><strong>Email:</strong> {customerData.email}</p>\n\n      <h3 style={styles.orderHeader}>Your Orders</h3>\n      {orders.length > 0 ? (\n        <ul style={styles.orderList}>\n          {orders.map((order) => (\n            <li key={order.id} style={styles.orderItem}>\n              <p><strong>Order ID:</strong> {order.id}</p>\n              <p><strong>Total Price:</strong> ${order.total}</p>\n              <p><strong>Status:</strong> {order.status}</p>\n\n              {/* View Order Button */}\n              <button \n                style={styles.viewButton} \n                onClick={() => handleOrderClick(order)}\n              >\n                View Details\n              </button>\n\n              {/* Cancel Order Button (only if order is not completed) */}\n              {order.status !== \"completed\" && order.status !== \"cancelled\" && (\n                <button \n                  style={styles.cancelButton} \n                  onClick={() => handleCancelOrder(order.id)}\n                >\n                  Cancel Order\n                </button>\n              )}\n            </li>\n          ))}\n        </ul>\n      ) : (\n        <p style={styles.text}>No orders placed yet.</p>\n      )}\n    </div>\n  );\n};\n\n// ðŸŽ¨ Inline Styles\nconst styles = {\n  profile: {\n    maxWidth: '600px',\n    margin: '40px auto',\n    padding: '20px',\n    background: '#fff',\n    boxShadow: '0 0 10px rgba(0, 0, 0, 0.1)',\n    borderRadius: '10px',\n    textAlign: 'center'\n  },\n  header: {\n    fontSize: '24px',\n    marginBottom: '10px',\n    color: '#333'\n  },\n  text: {\n    fontSize: '16px',\n    margin: '5px 0',\n    color: '#555'\n  },\n  orderHeader: {\n    marginTop: '20px',\n    fontSize: '20px',\n    color: '#444'\n  },\n  orderList: {\n    listStyle: 'none',\n    padding: 0\n  },\n  orderItem: {\n    background: '#f8f8f8',\n    padding: '15px',\n    margin: '10px 0',\n    borderRadius: '8px',\n    transition: '0.3s'\n  },\n  viewButton: {\n    background: '#007bff',\n    color: 'white',\n    border: 'none',\n    padding: '8px 12px',\n    margin: '5px',\n    fontSize: '14px',\n    cursor: 'pointer',\n    borderRadius: '5px',\n    transition: '0.3s'\n  },\n  cancelButton: {\n    background: '#ff4d4d',\n    color: 'white',\n    border: 'none',\n    padding: '8px 12px',\n    margin: '5px',\n    fontSize: '14px',\n    cursor: 'pointer',\n    borderRadius: '5px',\n    transition: '0.3s'\n  }\n};\n\nexport default CustomerProfile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}