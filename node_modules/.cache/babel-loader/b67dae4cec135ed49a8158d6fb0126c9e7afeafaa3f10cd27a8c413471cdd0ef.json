{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{firestore,auth}from\"../firebase/firebaseConfig\";import{collection,addDoc,Timestamp}from\"firebase/firestore\";import{useLocation,useNavigate}from\"react-router-dom\";import\"./order.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Order=()=>{var _location$state;const location=useLocation();const navigate=useNavigate();const dish=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.dish)||null;useEffect(()=>{if(!dish){console.error(\"No dish found, redirecting to homepage.\");navigate(\"/home\");}},[dish,navigate]);const[totalPrice,setTotalPrice]=useState(0);const[deliveryAddress,setDeliveryAddress]=useState(\"\");useEffect(()=>{if(dish){setTotalPrice(dish.price);}},[dish]);const handlePlaceOrder=async()=>{const user=auth.currentUser;if(!user){alert(\"You must be logged in to place an order!\");return;}if(!deliveryAddress){alert(\"Please enter a delivery address.\");return;}try{await addDoc(collection(firestore,\"orders\"),{customerId:user.uid,dishId:dish.id,dishName:dish.name,total:totalPrice,status:\"pending\",orderDate:Timestamp.fromDate(new Date()),paymentStatus:\"pending\",deliveryAddress});alert(\"Order placed successfully!\");navigate(\"/home\");// Redirect to home after order\n}catch(error){console.error(\"Error placing order:\",error);alert(\"Error placing order. Please try again.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"order-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Order Summary\"}),dish?/*#__PURE__*/_jsxs(\"div\",{className:\"order-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[dish.name,\" - \",dish.price]}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Total: \",totalPrice]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter delivery address\",value:deliveryAddress,onChange:e=>setDeliveryAddress(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePlaceOrder,className:\"place-order-btn\",children:\"Place Order\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Redirecting...\"})]});};export default Order;","map":{"version":3,"names":["React","useState","useEffect","firestore","auth","collection","addDoc","Timestamp","useLocation","useNavigate","jsx","_jsx","jsxs","_jsxs","Order","_location$state","location","navigate","dish","state","console","error","totalPrice","setTotalPrice","deliveryAddress","setDeliveryAddress","price","handlePlaceOrder","user","currentUser","alert","customerId","uid","dishId","id","dishName","name","total","status","orderDate","fromDate","Date","paymentStatus","className","children","type","placeholder","value","onChange","e","target","onClick"],"sources":["/home/user/Documents/a11/Homely/src/pages/Order.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { firestore, auth } from \"../firebase/firebaseConfig\";\nimport { collection, addDoc, Timestamp } from \"firebase/firestore\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport \"./order.css\";\n\nconst Order = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const dish = location.state?.dish || null;\n\n  useEffect(() => {\n    if (!dish) {\n      console.error(\"No dish found, redirecting to homepage.\");\n      navigate(\"/home\");\n    }\n  }, [dish, navigate]);\n\n  const [totalPrice, setTotalPrice] = useState(0);\n  const [deliveryAddress, setDeliveryAddress] = useState(\"\");\n\n  useEffect(() => {\n    if (dish) {\n      setTotalPrice(dish.price);\n    }\n  }, [dish]);\n\n  const handlePlaceOrder = async () => {\n    const user = auth.currentUser;\n    if (!user) {\n      alert(\"You must be logged in to place an order!\");\n      return;\n    }\n\n    if (!deliveryAddress) {\n      alert(\"Please enter a delivery address.\");\n      return;\n    }\n\n    try {\n      await addDoc(collection(firestore, \"orders\"), {\n        customerId: user.uid,\n        dishId: dish.id,\n        dishName: dish.name,\n        total: totalPrice,\n        status: \"pending\",\n        orderDate: Timestamp.fromDate(new Date()),\n        paymentStatus: \"pending\",\n        deliveryAddress,\n      });\n\n      alert(\"Order placed successfully!\");\n      navigate(\"/home\"); // Redirect to home after order\n    } catch (error) {\n      console.error(\"Error placing order:\", error);\n      alert(\"Error placing order. Please try again.\");\n    }\n  };\n\n  return (\n    <div className=\"order-container\">\n      <h3>Order Summary</h3>\n      {dish ? (\n        <div className=\"order-details\">\n          <p>{dish.name} - {dish.price}</p>\n          <h4>Total: {totalPrice}</h4>\n          <input\n            type=\"text\"\n            placeholder=\"Enter delivery address\"\n            value={deliveryAddress}\n            onChange={(e) => setDeliveryAddress(e.target.value)}\n          />\n          <button onClick={handlePlaceOrder} className=\"place-order-btn\">\n            Place Order\n          </button>\n        </div>\n      ) : (\n        <p>Redirecting...</p>\n      )}\n    </div>\n  );\n};\n\nexport default Order;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}